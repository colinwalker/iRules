when HTTP_RESPONSE { 
  HTTP::collect 
}

when HTTP_RESPONSE_DATA { 
  switch -glob [string tolower [HTTP::payload]] { 
    "*0novel.com*" - 
     "*dota11.cn*" - 
     "*wuqing17173.cn*" - 
     "*woai117.cn*" - 
     "*guccime.net*" - 
    "*play0nlnie.com*" { 
      HTTP::respond 200 content "The server is currently unable to serve the requested content. Please try again later." 
      log local0. "Adobe Flash exploit infected Server IP: [IP::server_addr]." 
    } 
  } 
  HTTP::release 
}
